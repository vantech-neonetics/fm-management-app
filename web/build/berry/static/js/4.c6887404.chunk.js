"use strict";(self.webpackChunkone_api_web=self.webpackChunkone_api_web||[]).push([[4],{7473:function(e,t,a){a.d(t,{A:function(){return j}});var i=a(1045),n=a(6446),s=a(310),r=a(2110),o=a(5043);var c=a.p+"static/media/shape-avatar.096ea8015d2d14ba4ce707d949a97823.svg",l=a.p+"static/media/cover.ce8466cd4be184bb082b.jpg",d=a(163),h=a(5173),x=a.n(h),u=a(579);const p=(0,o.forwardRef)(((e,t)=>{let{src:a,sx:i,...s}=e;return(0,u.jsx)(n.A,{component:"span",className:"svg-color",ref:t,sx:{width:24,height:24,display:"inline-block",bgcolor:"currentColor",mask:`url(${a}) no-repeat center / contain`,WebkitMask:`url(${a}) no-repeat center / contain`,...i},...s})}));p.propTypes={src:x().string,sx:x().object};var m=p;function j(e){let{children:t}=e;const a=(0,u.jsx)(m,{color:"paper",src:c,sx:{width:"100%",height:62,zIndex:10,bottom:-26,position:"absolute",color:"background.paper"}}),o=(0,u.jsx)(i.A,{src:d.A,sx:{zIndex:11,width:64,height:64,position:"absolute",alignItems:"center",marginLeft:"auto",marginRight:"auto",left:0,right:0,bottom:e=>e.spacing(-4)}}),h=(0,u.jsx)(n.A,{component:"img",src:l,sx:{top:0,width:1,height:1,objectFit:"cover",position:"absolute"}});return(0,u.jsxs)(r.A,{children:[(0,u.jsxs)(n.A,{sx:{position:"relative","&:after":{top:0,content:"''",width:"100%",height:"100%",position:"absolute",bgcolor:e=>(0,s.X4)(e.palette.primary.main,.42)},pt:{xs:"calc(100% / 3)",sm:"calc(100% / 4.66)"}},children:[a,o,h]}),(0,u.jsx)(n.A,{sx:{p:e=>e.spacing(4,3,3,3)},children:t})]})}},6585:function(e,t,a){a.r(t),a.d(t,{default:function(){return T}});var i=a(5043),n=a(8903),s=a(5865),r=a(3440),o=a(4535),c=a(6240),l=a(6446),d=a(2019),h=a(2330),x=a(2110),u=a(6494),p=a(8185),m=a(579);var j=()=>(0,m.jsx)(x.A,{children:(0,m.jsx)(u.A,{children:(0,m.jsxs)(n.Ay,{container:!0,direction:"column",children:[(0,m.jsx)(n.Ay,{item:!0,children:(0,m.jsxs)(n.Ay,{container:!0,justifyContent:"space-between",children:[(0,m.jsx)(n.Ay,{item:!0,children:(0,m.jsx)(p.A,{variant:"rectangular",width:44,height:44})}),(0,m.jsx)(n.Ay,{item:!0,children:(0,m.jsx)(p.A,{variant:"rectangular",width:34,height:34})})]})}),(0,m.jsx)(n.Ay,{item:!0,children:(0,m.jsx)(p.A,{variant:"rectangular",sx:{my:2},height:40})}),(0,m.jsx)(n.Ay,{item:!0,children:(0,m.jsx)(p.A,{variant:"rectangular",height:30})})]})})});const g=(0,o.Ay)(h.A)((e=>{let{theme:t}=e;return{...t.typography.CardWrapper,color:"#fff",overflow:"hidden",position:"relative","&>div":{position:"relative",zIndex:5},"&:after":{content:'""',position:"absolute",width:210,height:210,background:t.palette.primary[800],borderRadius:"50%",zIndex:1,top:-85,right:-95,[t.breakpoints.down("sm")]:{top:-105,right:-140}},"&:before":{content:'""',position:"absolute",zIndex:1,width:210,height:210,background:t.palette.primary[800],borderRadius:"50%",top:-125,right:-15,opacity:.5,[t.breakpoints.down("sm")]:{top:-155,right:-70}}}}));var y=e=>{let{isLoading:t,title:a,chartData:i,todayValue:r}=e;const o=(0,c.A)();return(0,m.jsx)(m.Fragment,{children:t?(0,m.jsx)(j,{}):(0,m.jsx)(g,{border:!1,content:!1,children:(0,m.jsx)(l.A,{sx:{p:2.25},children:(0,m.jsx)(n.Ay,{children:(0,m.jsx)(n.Ay,{item:!0,sx:{mb:.75},children:(0,m.jsxs)(n.Ay,{container:!0,alignItems:"center",children:[(0,m.jsx)(n.Ay,{item:!0,xs:6,children:(0,m.jsxs)(n.Ay,{container:!0,alignItems:"center",children:[(0,m.jsx)(n.Ay,{item:!0,children:(0,m.jsx)(s.A,{sx:{fontSize:"2.125rem",fontWeight:500,mr:1,mt:1.75,mb:.75},children:r||"0"})}),(0,m.jsx)(n.Ay,{item:!0}),(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsx)(s.A,{sx:{fontSize:"1rem",fontWeight:500,color:o.palette.primary[200]},children:a})})]})}),(0,m.jsx)(n.Ay,{item:!0,xs:6,children:i?(0,m.jsx)(d.A,{...i}):(0,m.jsx)(s.A,{sx:{fontSize:"1rem",fontWeight:500,color:o.palette.primary[200]},children:"\u65e0\u6570\u636e"})})]})})})})})})};var A=()=>(0,m.jsx)(x.A,{children:(0,m.jsx)(u.A,{children:(0,m.jsxs)(n.Ay,{container:!0,spacing:r.iL,children:[(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsxs)(n.Ay,{container:!0,alignItems:"center",justifyContent:"space-between",spacing:r.iL,children:[(0,m.jsx)(n.Ay,{item:!0,xs:!0,zeroMinWidth:!0,children:(0,m.jsxs)(n.Ay,{container:!0,spacing:1,children:[(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsx)(p.A,{variant:"text"})}),(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsx)(p.A,{variant:"rectangular",height:20})})]})}),(0,m.jsx)(n.Ay,{item:!0,children:(0,m.jsx)(p.A,{variant:"rectangular",height:50,width:80})})]})}),(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsx)(p.A,{variant:"rectangular",height:530})})]})})});var f=e=>{let{isLoading:t,chartDatas:a}=e;return b.options.xaxis.categories=a.xaxis,b.series=a.data,(0,m.jsx)(m.Fragment,{children:t?(0,m.jsx)(A,{}):(0,m.jsx)(h.A,{children:(0,m.jsxs)(n.Ay,{container:!0,spacing:r.iL,children:[(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsx)(n.Ay,{container:!0,alignItems:"center",justifyContent:"space-between",children:(0,m.jsx)(n.Ay,{item:!0,children:(0,m.jsx)(s.A,{variant:"h3",children:"\u7edf\u8ba1"})})})}),(0,m.jsx)(n.Ay,{item:!0,xs:12,children:b.series?(0,m.jsx)(d.A,{...b}):(0,m.jsx)(l.A,{sx:{minHeight:"490px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,m.jsx)(s.A,{variant:"h3",color:"#697586",children:"\u6682\u65e0\u6570\u636e"})})})]})})})};const b={height:480,type:"bar",options:{colors:["#008FFB","#00E396","#FEB019","#FF4560","#775DD0","#55efc4","#81ecec","#74b9ff","#a29bfe","#00b894","#00cec9","#0984e3","#6c5ce7","#ffeaa7","#fab1a0","#ff7675","#fd79a8","#fdcb6e","#e17055","#d63031","#e84393"],chart:{id:"bar-chart",stacked:!0,toolbar:{show:!0},zoom:{enabled:!0}},responsive:[{breakpoint:480,options:{legend:{position:"bottom",offsetX:-10,offsetY:0}}}],plotOptions:{bar:{horizontal:!1,columnWidth:"50%"}},xaxis:{type:"category",categories:[]},legend:{show:!0,fontSize:"14px",fontFamily:"'Roboto', sans-serif",position:"bottom",offsetX:20,labels:{useSeriesColors:!1},markers:{width:16,height:16,radius:5},itemMargin:{horizontal:15,vertical:8}},fill:{type:"solid"},dataLabels:{enabled:!1},grid:{show:!0},tooltip:{theme:"dark",fixed:{enabled:!1},y:{formatter:function(e){return"$"+e}},marker:{show:!1}}},series:[]};function v(){const e=[];for(let t=6;t>=0;t--){const a=new Date;a.setDate(a.getDate()-t);const i=""+(a.getMonth()+1),n=""+a.getDate(),s=[a.getFullYear(),i.padStart(2,"0"),n.padStart(2,"0")].join("-");e.push(s)}return e}function k(e,t){const a=e.map((e=>e.date)),i=e.map((e=>e.value));return{series:[{data:i}],type:"line",height:90,options:{chart:{sparkline:{enabled:!0},background:"transparent"},dataLabels:{enabled:!1},colors:["#fff"],fill:{type:"solid",opacity:1},stroke:{curve:"smooth",width:3},xaxis:{categories:a,labels:{show:!1},min:a[0],max:a[a.length-1]},yaxis:{min:Math.min(...i),max:Math.max(...i),labels:{show:!1}},tooltip:{theme:"dark",fixed:{enabled:!1},x:{format:"yyyy-MM-dd"},y:{formatter:function(e){return e+` ${t}`},title:{formatter:function(){return""}}},marker:{show:!1}}}}}var w=a(3862),D=a(9985),C=a(7473);var T=()=>{const[e,t]=(0,i.useState)(!0),[a,o]=(0,i.useState)([]),[c,l]=(0,i.useState)(null),[d,h]=(0,i.useState)(null),[x,u]=(0,i.useState)(null),[p,j]=(0,i.useState)([]),g=async()=>{const e=await w.n.get("/api/user/dashboard"),{success:a,message:i,data:n}=e.data;if(a){if(n){let e=function(e){let t=e.reduce(((e,t)=>(e[t.Day]||(e[t.Day]={date:t.Day,RequestCount:0,Quota:0,PromptTokens:0,CompletionTokens:0}),e[t.Day].RequestCount+=t.RequestCount,e[t.Day].Quota+=t.Quota,e[t.Day].PromptTokens+=t.PromptTokens,e[t.Day].CompletionTokens+=t.CompletionTokens,e)),{});return v().map((e=>t[e]?t[e]:{date:e,RequestCount:0,Quota:0,PromptTokens:0,CompletionTokens:0}))}(n);l(L(e,"RequestCount")),h(L(e,"Quota")),u(L(e,"PromptTokens")),o(function(e){const t=v(),a=[],i=new Map;for(const n of e){if(!i.has(n.ModelName)){const e={name:n.ModelName,data:new Array(7)};i.set(n.ModelName,e),a.push(e)}const e=t.indexOf(n.Day);-1!==e&&(i.get(n.ModelName).data[e]=(0,D.x0)(n.Quota,3))}for(const n of a)for(let e=0;e<7;e++)void 0===n.data[e]&&(n.data[e]=0);return{data:a,xaxis:t}}(n))}}else(0,D.Qg)(i);t(!1)};return(0,i.useEffect)((()=>{g(),(async()=>{let e=await w.n.get("/api/user/self");const{success:t,message:a,data:i}=e.data;t?j(i):(0,D.Qg)(a)})()}),[]),(0,m.jsxs)(n.Ay,{container:!0,spacing:r.iL,children:[(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsxs)(n.Ay,{container:!0,spacing:r.iL,children:[(0,m.jsx)(n.Ay,{item:!0,lg:4,xs:12,children:(0,m.jsx)(y,{isLoading:e,title:"\u4eca\u65e5\u8bf7\u6c42\u91cf",chartData:null===c||void 0===c?void 0:c.chartData,todayValue:null===c||void 0===c?void 0:c.todayValue})}),(0,m.jsx)(n.Ay,{item:!0,lg:4,xs:12,children:(0,m.jsx)(y,{isLoading:e,title:"\u4eca\u65e5\u6d88\u8d39",chartData:null===d||void 0===d?void 0:d.chartData,todayValue:null===d||void 0===d?void 0:d.todayValue})}),(0,m.jsx)(n.Ay,{item:!0,lg:4,xs:12,children:(0,m.jsx)(y,{isLoading:e,title:"\u4eca\u65e5 token",chartData:null===x||void 0===x?void 0:x.chartData,todayValue:null===x||void 0===x?void 0:x.todayValue})})]})}),(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsxs)(n.Ay,{container:!0,spacing:r.iL,children:[(0,m.jsx)(n.Ay,{item:!0,lg:8,xs:12,children:(0,m.jsx)(f,{isLoading:e,chartDatas:a})}),(0,m.jsx)(n.Ay,{item:!0,lg:4,xs:12,children:(0,m.jsx)(C.A,{children:(0,m.jsxs)(n.Ay,{container:!0,spacing:r.iL,justifyContent:"center",alignItems:"center",paddingTop:"20px",children:[(0,m.jsx)(n.Ay,{item:!0,xs:4,children:(0,m.jsx)(s.A,{variant:"h4",children:"\u4f59\u989d\uff1a"})}),(0,m.jsx)(n.Ay,{item:!0,xs:8,children:(0,m.jsxs)(s.A,{variant:"h3",children:[" ",null!==p&&void 0!==p&&p.quota?"$"+(0,D.x0)(p.quota):"\u672a\u77e5"]})}),(0,m.jsx)(n.Ay,{item:!0,xs:4,children:(0,m.jsx)(s.A,{variant:"h4",children:"\u5df2\u4f7f\u7528\uff1a"})}),(0,m.jsx)(n.Ay,{item:!0,xs:8,children:(0,m.jsxs)(s.A,{variant:"h3",children:[" ",null!==p&&void 0!==p&&p.used_quota?"$"+(0,D.x0)(p.used_quota):"\u672a\u77e5"]})}),(0,m.jsx)(n.Ay,{item:!0,xs:4,children:(0,m.jsx)(s.A,{variant:"h4",children:"\u8c03\u7528\u6b21\u6570\uff1a"})}),(0,m.jsx)(n.Ay,{item:!0,xs:8,children:(0,m.jsxs)(s.A,{variant:"h3",children:[" ",(null===p||void 0===p?void 0:p.request_count)||"\u672a\u77e5"]})})]})})})]})})]})};function L(e,t){let a=0,i=null;const n=e.length-1;let s=e.map(((e,i)=>{let s={date:e.date,value:e[t]};switch(t){case"Quota":s.value=(0,D.x0)(e.Quota,3);break;case"PromptTokens":s.value+=e.CompletionTokens}return i==n&&(a=s.value),s}));switch(t){case"RequestCount":i=k(s,"\u6b21"),a=(0,D.kT)(a);break;case"Quota":i=k(s,"\u7f8e\u5143"),a="$"+(0,D.kT)(a);break;case"PromptTokens":i=k(s,""),a=(0,D.kT)(a)}return{chartData:i,todayValue:a}}}}]);
//# sourceMappingURL=4.c6887404.chunk.js.map